<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/wechatlogo32*32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/wechatlogo16*16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CLobster+Two:300,300italic,400,400italic,700,700italic%7CAmita:300,300italic,400,400italic,700,700italic%7CMontserrat:300,300italic,400,400italic,700,700italic%7CPT+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.iosprogrammer.tech","root":"/","images":"/images","scheme":"Gemini","version":"8.2.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}};
  </script>
<meta name="description" content="åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§">
<meta property="og:type" content="website">
<meta property="og:title" content="iOSå¼€å‘æ ˆ">
<meta property="og:url" content="http://www.iosprogrammer.tech/page/5/index.html">
<meta property="og:site_name" content="iOSå¼€å‘æ ˆ">
<meta property="og:description" content="åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="æ–½æ²»æ˜‚">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://www.iosprogrammer.tech/page/5/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<title>iOSå¼€å‘æ ˆ</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127387039-1"></script>
    <script data-pjax>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-127387039-1');
      }
    </script>




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="iOSå¼€å‘æ ˆ" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">iOSå¼€å‘æ ˆ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">æ–½æ²»æ˜‚</p>
  <div class="site-description" itemprop="description">åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">38</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:shizhiang@126.com" title="E-Mail â†’ mailto:shizhiang@126.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/7414691003/profile" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;7414691003&#x2F;profile" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.iosprogrammer.tech/learn-react-native-with-me-questions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="æ–½æ²»æ˜‚">
      <meta itemprop="description" content="åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="iOSå¼€å‘æ ˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/learn-react-native-with-me-questions/" class="post-title-link" itemprop="url">è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-06-11 11:44:22" itemprop="dateCreated datePublished" datetime="2018-06-11T11:44:22+08:00">2018-06-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-01-15 18:20:09" itemprop="dateModified" datetime="2021-01-15T18:20:09+08:00">2021-01-15</time>
      </span>

  
    <span id="/learn-react-native-with-me-questions/" class="post-meta-item leancloud_visitors" data-flag-title="è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span class="leancloud-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>è¿™ç¯‡æ–‡ç« æ˜¯â€œ<a href="http://www.iosprogrammer.tech/categories/react-native/">è·Ÿæˆ‘ä¸€èµ·å­¦react-native</a>â€ç³»åˆ—æ–‡ç« çš„ç­”ç–‘ç¯‡ã€‚è¿™ç³»åˆ—æ–‡ç« ä¼šæŒç»­æ›´æ–°ã€‚æƒ³è¦è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ RNçš„æœ‹å‹å¯ä»¥å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·iOSè¿›é˜¶æŒ‡å—ï¼Œæˆ–è€…è®¢é˜…<a href="http://www.iosprogrammer.tech/">æˆ‘çš„ä¸ªäººåšå®¢</a>ã€‚</p>
<ol>
<li>No bundle URL present.<br><br><br> <img src="http://image.iosprogrammer.hongbility.com/react-native/problem-1.png" alt="No bundle URL present"><br><br><blockquote>
<ul>
<li>Run â€œreact-native run-iosâ€</li>
<li>When the error appears, run â€œnpm installâ€</li>
<li>Then run â€œreact-native run-iosâ€ again.</li>
</ul>
</blockquote>
</li>
<li>isMounted(â€¦) is deprecated in plain JavaScript React classesâ€¦</li>
<li>Class RCTCxxModule was not exported. Did you forget to use RCT_EXPORT_MODULE()?<br>è¿™ä¸¤ä¸ªç›®å‰æ²¡æ‰¾åˆ°å¥½çš„è§£å†³åŠæ³•ï¼Œæš‚æ—¶éšè—è­¦å‘Šå§ï¼Œä»¥åæ‰¾åˆ°å¥½çš„åŠæ³•å†æ›´æ–°ã€‚<br>è¿™ä¸ªé—®é¢˜åœ¨react-navigationçš„githubä¸»é¡µé‡Œé¢æœ‰ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://github.com/react-navigation/react-navigation/issues/3956">ä¸“é—¨çš„issue</a>ï¼Œä½†æ˜¯æ ¹æ®react-navigationçš„å¼€å‘è€…è¯´è¿™ä¸ªæ˜¯react-nativeå†…éƒ¨è°ƒç”¨äº†åºŸå¼ƒçš„æ–¹æ³•æ‰€è‡³ã€‚<br>ç›®å‰å¤§å®¶çš„ç»Ÿä¸€è§£å†³åŠæ³•æ˜¯åœ¨index.jsæ–‡ä»¶ä¸­æ·»åŠ <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#123; YellowBox &#125; from &#39;react-native&#39;;</span><br><span class="line">YellowBox.ignoreWarnings([&#39;Warning: isMounted(...) is deprecated&#39;, &#39;Module RCTImageLoader&#39;]);</span><br><span class="line">YellowBox.ignoreWarnings([&#39;Class RCTCxxModule&#39;]);</span><br></pre></td></tr></table></figure></li>
<li>ImageåŠ è½½ä¸å‡ºæ¥ï¼Œonloadä¸æ‰§è¡Œçš„é—®é¢˜ã€‚<br>iOS 8ä»¥ä¸Šï¼Œé»˜è®¤ä¸æ”¯æŒHTTPã€‚éœ€è¦åœ¨info.plistä¸­è®¾ç½®App Transport Security Settings -&gt; Allow Arbitray Loads = YES</li>
<li>RCTBridge required dispatch_sync to load RCTDevLoadingView. This may lead to deadlocks.<br>APPDelegate.m<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">#if RCT_DEV</span><br><span class="line">#import &lt;React&#x2F;RCTDevLoadingView.h&gt;</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">@implementation AppDelegate</span><br><span class="line"></span><br><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">  NSURL *jsCodeLocation;</span><br><span class="line"></span><br><span class="line">  jsCodeLocation &#x3D; [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@&quot;index&quot; fallbackResource:nil];</span><br><span class="line">  </span><br><span class="line">  RCTBridge *bridge &#x3D; [[RCTBridge alloc] initWithBundleURL:jsCodeLocation</span><br><span class="line">                                            moduleProvider:nil</span><br><span class="line">                                             launchOptions:launchOptions];</span><br><span class="line">#if RCT_DEV</span><br><span class="line">  [bridge moduleForClass:[RCTDevLoadingView class]];</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">  RCTRootView *rootView &#x3D; [[RCTRootView alloc] initWithBridge:bridge moduleName:@&quot;rn_shuidi&quot; initialProperties:launchOptions];</span><br><span class="line">  rootView.backgroundColor &#x3D; [[UIColor alloc] initWithRed:1.0f green:1.0f blue:1.0f alpha:1];</span><br><span class="line"></span><br><span class="line">  self.window &#x3D; [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];</span><br><span class="line">  UIViewController *rootViewController &#x3D; [UIViewController new];</span><br><span class="line">  rootViewController.view &#x3D; rootView;</span><br><span class="line">  self.window.rootViewController &#x3D; rootViewController;</span><br><span class="line">  [self.window makeKeyAndVisible];</span><br><span class="line">  return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<div><h1>æ¨èæ–‡ç« <span style="font-size:0.45em; color:gray"></span></h1><ul><li><a href="http://www.iosprogrammer.tech/learn-react-native-with-me-call-native/">è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹è°ƒç”¨åŸç”Ÿæ¨¡å—</a></li><li><a href="http://www.iosprogrammer.tech/learn-react-native-with-me-mine-and-settings/">è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹æˆ‘çš„å’Œè®¾ç½®</a></li><li><a href="http://www.iosprogrammer.tech/learn-react-native-with-me-project-instruction/">è·Ÿæˆ‘ä¸€èµ·å­¦React Nativeä¹‹é¡¹ç›®ç»“æ„æ­å»º</a></li></ul></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.iosprogrammer.tech/learn-react-native-with-me-construction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="æ–½æ²»æ˜‚">
      <meta itemprop="description" content="åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="iOSå¼€å‘æ ˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/learn-react-native-with-me-construction/" class="post-title-link" itemprop="url">è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹ç¯å¢ƒæ­å»º</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-06-11 11:40:03" itemprop="dateCreated datePublished" datetime="2018-06-11T11:40:03+08:00">2018-06-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-01-15 18:20:09" itemprop="dateModified" datetime="2021-01-15T18:20:09+08:00">2021-01-15</time>
      </span>

  
    <span id="/learn-react-native-with-me-construction/" class="post-meta-item leancloud_visitors" data-flag-title="è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹ç¯å¢ƒæ­å»º" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span class="leancloud-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>è¿™ç¯‡æ–‡ç« æ˜¯â€œ<a href="http://www.iosprogrammer.tech/categories/react-native/">è·Ÿæˆ‘ä¸€èµ·å­¦react-native</a>â€ç³»åˆ—æ–‡ç« çš„ç¬¬ä¸€ç¯‡ã€‚è¿™ç³»åˆ—æ–‡ç« ä¼šæŒç»­æ›´æ–°ã€‚æƒ³è¦è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeçš„æœ‹å‹å¯ä»¥å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·<strong>iOSè¿›é˜¶æŒ‡å—</strong>ï¼Œæˆ–è€…è®¢é˜…<a href="http://www.iosprogrammer.tech/">æˆ‘çš„ä¸ªäººåšå®¢</a>ã€‚</p>
<h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>æœ€è¿‘æƒ³è¦åšä¸€æ¬¾æ–°é—»ç±»çš„Appï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯æŠŠæ–°é—»äº‹ä»¶æŒ‰ç…§æ—¶é—´çº¿æ•´ç†å‡ºæ¥æ–¹ä¾¿è·Ÿè¸ªäº‹æƒ…çš„å‘å±•ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªé›·ï¼ˆxiaï¼‰å‰ï¼ˆbiï¼‰é£ï¼ˆdaoï¼‰è¡Œï¼ˆguï¼‰çš„ç¨‹åºå‘˜è‚¯å®šè¯´å¹²å°±å¹²ã€‚</p>
<p>ä¿—è¯è¯´ä¸æƒ³ç«çš„åº”ç”¨ä¸æ˜¯å¥½Appï¼Œæƒ³è¦æ›´å¤šçš„ç”¨æˆ·è‚¯å®šä¸èƒ½åªå±€é™äºä¸€ä¸ªå¹³å°ï¼Œé‚£å°±è¦è®©è¿™ä¸ªåº”ç”¨åŒæ—¶ç™»é™†å®‰å“å’ŒiOSä¸¤ä¸ªå¹³å°ã€‚ä½†æ˜¯æˆ‘ä½œä¸ºä¸€ä¸ªä¸‡å¹´iOSerï¼Œç°åœ¨ä»å¤´å¼€å§‹å­¦å®‰å“ææ€•æœ‰ç‚¹ä¸èµ¶è¶Ÿäº†ã€‚</p>
<p>æ ¹æ®å½“å‰æ•Œæˆ‘æ€åŠ¿å’Œæ¶åŠ£çš„ç¯å¢ƒï¼Œè·¨å¹³å°å¼€å‘æˆä¸ºäº†æœ€ä¼˜é€‰æ‹©ã€‚</p>
<p>é‚£æ€ä¹ˆæ ·è¾¾åˆ°è·¨å¹³å°å¼€å‘çš„ç›®çš„å‘¢ï¼Ÿæ ¹æ®ç™¾åº¦çˆ¸çˆ¸çš„æŒ‡å¯¼å’Œä»¥å¾€çš„æ‰€è§æ‰€é—»ï¼Œå°±è¦åœ¨é˜¿é‡Œçš„weexå’ŒFacebookçš„react-nativeä¸­äºŒé€‰ä¸€äº†ã€‚</p>
<p>ä»è¿™ç¯‡æ–‡ç« çš„æ ‡é¢˜æ¥çœ‹ï¼Œå¤§å®¶è‚¯å®šçŸ¥é“è¦é€‰rnï¼Œå…¶å®æœ€å¼€å§‹æˆ‘é€‰çš„æ˜¯weexï¼Œå¥ˆä½•ç»è¿‡ä¸‰å››å¤©çš„å¥‹æˆ˜å’Œå››å¤„æ±‚æ•™ï¼Œæˆ‘å®åœ¨æ˜¯æ²¡æœ‰æå®šç¯å¢ƒï¼Œåœ¨è¿™é‡Œä¸å¾—ä¸è¯´weexçš„å®˜æ–¹æ–‡æ¡£çœŸçš„å¯ä»¥ç§°ä¸ºç®€é™‹ï¼Œå½“ç„¶æˆ‘å¯èƒ½æ˜¯å› ä¸ºæˆ‘å‰å‡ å¤©æ‰‹è´±æŠŠMacçš„ç³»ç»Ÿå‡çº§åˆ°äº†Mojaveã€‚</p>
<p>åœ¨ä¸å¾—ä¸æ”¾å¼ƒweexä»¥åï¼Œåªèƒ½ğŸ™RNèƒ½ç»™ç‚¹é¢å­ã€‚å¤šäºä¸Šå¤©çœ·é¡¾ï¼Œç¯å¢ƒç¨å¾®æŠ˜è…¾äº†ä¸€ä¸‹å°±æå®šäº†ã€‚</p>
<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><ol>
<li><p>å®‰è£…Nodeå’ŒWatchman</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br><span class="line">brew install watchman</span><br></pre></td></tr></table></figure>
<p> å…¶ä¸­ï¼Œnodeéœ€è¦æ˜¯8æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬ã€‚Watchmanæ˜¯Facebookç”¨æ¥ç›‘è§†æ–‡ä»¶ç³»ç»Ÿæ›´æ”¹çš„å·¥å…·ï¼ŒRNå¼ºçƒˆå»ºè®®ä½¿ç”¨ã€‚</p>
</li>
<li><p>å®‰è£…React Native command line interface.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g react-native-cli</span><br></pre></td></tr></table></figure></li>
<li><p>åˆ›å»ºé¡¹ç›®</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native init rn-test</span><br></pre></td></tr></table></figure></li>
<li><p>è¿è¡Œé¡¹ç›®</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd rn-test</span><br><span class="line">react-native run-ios</span><br></pre></td></tr></table></figure>
<p> é¡¹ç›®é»˜è®¤ä¼šåœ¨iPhone 6çš„æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œã€‚<br><br> <img src="http://image.iosprogrammer.hongbility.com/react-native/new-project-screenshot.png" alt="iPhone 6 Screenshot"><br><br> è‡³æ­¤ï¼Œç¯å¢ƒæ­å»ºå®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å¦‚é‡åˆ°é—®é¢˜å¯ä»¥å‚è€ƒ<a href="http://www.iosprogrammer.tech/learn-react-native-with-me-questions">é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</a></p>
</li>
</ol>
<div><h1>æ¨èæ–‡ç« <span style="font-size:0.45em; color:gray"></span></h1><ul><li><a href="http://www.iosprogrammer.tech/learn-react-native-with-me-call-native/">è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹è°ƒç”¨åŸç”Ÿæ¨¡å—</a></li><li><a href="http://www.iosprogrammer.tech/learn-react-native-with-me-mine-and-settings/">è·Ÿæˆ‘ä¸€èµ·å­¦ä¹ React Nativeä¹‹æˆ‘çš„å’Œè®¾ç½®</a></li><li><a href="http://www.iosprogrammer.tech/learn-react-native-with-me-project-instruction/">è·Ÿæˆ‘ä¸€èµ·å­¦React Nativeä¹‹é¡¹ç›®ç»“æ„æ­å»º</a></li></ul></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.iosprogrammer.tech/WebSocket-And-SocketRocket-Source-Analysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="æ–½æ²»æ˜‚">
      <meta itemprop="description" content="åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="iOSå¼€å‘æ ˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/WebSocket-And-SocketRocket-Source-Analysis/" class="post-title-link" itemprop="url">WebSocketç®€ä»‹å’ŒSocketRocketæºç åˆ†æ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-06-02 21:16:10" itemprop="dateCreated datePublished" datetime="2018-06-02T21:16:10+08:00">2018-06-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-01-15 18:26:21" itemprop="dateModified" datetime="2021-01-15T18:26:21+08:00">2021-01-15</time>
      </span>

  
    <span id="/WebSocket-And-SocketRocket-Source-Analysis/" class="post-meta-item leancloud_visitors" data-flag-title="WebSocketç®€ä»‹å’ŒSocketRocketæºç åˆ†æ" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span class="leancloud-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="http://www.iosprogrammer.tech/iOS-SocketRocket/">ä¹‹å‰çš„æ–‡ç« </a>è®²äº†SocketRocketçš„ç”¨æ³•ï¼Œè¿™é‡Œè®²ä¸€ä¸‹ä»€ä¹ˆæ˜¯WebSocketå¹¶ä¸”å¯¹SocketRocketçš„æºç è¿›è¡Œåˆ†æã€‚</p>
<h3 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The WebSocket Protocol is an independent TCP-based protocol.&lt;br&gt;Its only relationship to HTTP is that its handshake is interpreted by HTTP servers as an Upgrade request.</span><br></pre></td></tr></table></figure>
<div align=center>
<img src="http://image.iosprogrammer.hongbility.com/WebSocket-SocketRocket-Source/6651f2f811ec133b0e6d7e6d0e194b4c_hd.jpg">
</div>

<p>WebSocketçš„ç‰¹ç‚¹:</p>
<pre><code>1. å»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Šï¼ŒæœåŠ¡å™¨ç«¯çš„å®ç°æ¯”è¾ƒå®¹æ˜“ã€‚
2. ä¸ HTTP åè®®æœ‰ç€è‰¯å¥½çš„å…¼å®¹æ€§ã€‚é»˜è®¤ç«¯å£ä¹Ÿæ˜¯80å’Œ443ï¼Œå¹¶ä¸”æ¡æ‰‹é˜¶æ®µé‡‡ç”¨ HTTP åè®®ï¼Œå› æ­¤æ¡æ‰‹æ—¶ä¸å®¹æ˜“å±è”½ï¼Œèƒ½é€šè¿‡å„ç§ HTTP ä»£ç†æœåŠ¡å™¨ã€‚
3. æ•°æ®æ ¼å¼æ¯”è¾ƒè½»é‡ï¼Œæ€§èƒ½å¼€é”€å°ï¼Œé€šä¿¡é«˜æ•ˆã€‚
4. å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ®ã€‚
5. æ²¡æœ‰åŒæºé™åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ä»»æ„æœåŠ¡å™¨é€šä¿¡ã€‚
6. åè®®æ ‡è¯†ç¬¦æ˜¯wsï¼ˆå¦‚æœåŠ å¯†ï¼Œåˆ™ä¸ºwssï¼‰ï¼ŒæœåŠ¡å™¨ç½‘å€å°±æ˜¯URLã€‚`ws://example.com:80/some/path`
7. å…¨åŒå·¥é€šä¿¡ã€‚</code></pre>
<p>WebSocketæ¡æ‰‹ç±»ä¼¼äºHTTPï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;chat HTTP&#x2F;1.1</span><br><span class="line">Host: server.example.com</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw&#x3D;&#x3D;</span><br><span class="line">Sec-WebSocket-Protocol: chat, superchat</span><br><span class="line">Sec-WebSocket-Version: 13</span><br><span class="line">Origin: http:&#x2F;&#x2F;example.com</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Upgradeå’ŒConnectionæ˜¯åœ¨é€šçŸ¥Apacheæˆ–è€…Nginxç­‰ä»£ç†æœåŠ¡å™¨ï¼Œæ­£åœ¨è¿›è¡Œçš„æ˜¯websocketåè®®è¿æ¥è€Œä¸æ˜¯æ™®é€šçš„HTTPã€‚<br><br>Sec-WebSocket-Keyæ˜¯æµè§ˆå™¨éšæœºç”Ÿæˆçš„base64ç¼–ç å€¼ï¼Œç”¨æ¥éªŒè¯æœåŠ¡å™¨æ˜¯ä¸æ˜¯çœŸæ­£çš„websocketã€‚<br> Sec_WebSocket-Protocol æ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥åŒºåˆ†åŒURLä¸‹ï¼Œä¸åŒçš„æœåŠ¡æ‰€éœ€è¦çš„åè®®ã€‚<br> Sec-WebSocket-Version æ˜¯å‘Šè¯‰æœåŠ¡å™¨æ‰€ä½¿ç”¨çš„åè®®ç‰ˆæœ¬ã€‚</p>
</blockquote>
<p>æœåŠ¡å™¨éªŒè¯é€šè¿‡åä¼šè¿”å›ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 101 Switching Protocols</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk&#x3D;</span><br><span class="line">Sec-WebSocket-Protocol: chat</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Upgradeå’ŒConnectionçš„ä½œç”¨åŒæ ·æ˜¯ä¸ºäº†è¡¨æ˜è¿›è¡Œçš„æ˜¯websocketè¿æ¥ã€‚<br><br>Sec-WebSocket-Accept è¿™ä¸ªåˆ™æ˜¯ç»è¿‡æœåŠ¡å™¨ç¡®è®¤ï¼Œå¹¶ä¸”åŠ å¯†è¿‡åçš„ Sec-WebSocket-Keyï¼Œç”¨æ¥ç»™å®¢æˆ·ç«¯éªŒè¯èº«ä»½ã€‚<br><br>Sec-WebSocket-Protocol åˆ™æ˜¯è¡¨ç¤ºæœ€ç»ˆä½¿ç”¨çš„åè®®ã€‚</p>
</blockquote>
<p>æ•°æ®å¸§ï¼š<br><br><img src="http://image.iosprogrammer.hongbility.com/WebSocket-SocketRocket-Source/frame_form.png" alt="æ•°æ®å¸§æ ¼å¼"></p>
<div align=center>
<font color="gray" size="2">æ•°æ®å¸§æ ¼å¼</font>
</div>

<ol>
<li><p>ä¸åŒäºå…¶ä»–åè®®ï¼ŒWebSocketæ˜¯åŸºäºå¸§çš„è€Œä¸æ˜¯åŸºäºæµ<br></p>
</li>
<li><p>å­—æ®µè§£é‡Š:</p>
<ol>
<li>FIN: 1 bit è¡¨ç¤ºæ˜¯å¦æ˜¯å½“å‰ä¿¡æ¯çš„æœ€åä¸€æ®µ</li>
<li>RSV1, RSV2, RSV3: 1 bit é™¤éåŒæ–¹åå•†å®šä¹‰äº†é0å€¼ï¼Œå¦åˆ™ä¸º0</li>
<li>Opcode: 4 bits å®šä¹‰äº†æ•°æ®åŒ…çš„ç±»å‹ï¼Œå¦‚æœä¸æ˜¯å·²å®šä¹‰ç±»å‹åˆ™è¡¨ç¤ºè¿æ¥å‡ºé”™ã€‚å®šä¹‰çš„æ•°æ®ç±»å‹åŒ…æ‹¬: 0x0è¡¨ç¤ºä¸­é—´æ•°æ®åŒ…ï¼›0x1è¡¨ç¤ºtextç±»å‹æ•°æ®åŒ…ï¼›0x2è¡¨ç¤ºbinaryç±»å‹æ•°æ®åŒ…ï¼›0x3-7ä¿ç•™ï¼›0x8è¡¨ç¤ºè¿æ¥å…³é—­ï¼›0x9è¡¨ç¤ºpingï¼›0xAè¡¨ç¤ºpongï¼›0xB-Fä¿ç•™</li>
<li>MASKï¼š1 bit è¡¨ç¤ºPayloadæ˜¯å¦ç»è¿‡æ©ç å¤„ç†ã€‚MASKå¦‚æœæ˜¯1ï¼ŒMasking-Keyçš„æ•°æ®å³æ˜¯æ©ç å¯†é’¥ï¼Œç”¨äºè§£ç PayloadDataã€‚å®¢æˆ·ç«¯å‘å‡ºçš„æ•°æ®å¸§éœ€è¦è¿›è¡Œæ©ç å¤„ç†ï¼Œæ‰€ä»¥æ­¤ä¸ºæ˜¯1ã€‚</li>
<li>Payload lengthï¼š7 bitï¼Œ7+16 bitsï¼Œor 7+64 bits è¡¨ç¤ºpayload dataçš„é•¿åº¦ï¼Œå¦‚æœå…¶å€¼æ˜¯0-125ï¼Œåˆ™æ˜¯payloadçš„çœŸå®é•¿åº¦ï¼›å¦‚æœæ˜¯126ï¼Œåˆ™åé¢çš„2ä¸ªå­—èŠ‚å½¢æˆçš„16bitsæ— ç¬¦å·æ•´å‹æ•°çš„å€¼æ˜¯payloadçš„çœŸå®é•¿åº¦ï¼›å¦‚æœæ˜¯127ï¼Œåˆ™åé¢8ä¸ªå­—èŠ‚å½¢æˆçš„64bitsæ— ç¬¦å·æ•´å‹æ•°çš„å€¼æ˜¯payloadçš„çœŸå®é•¿åº¦ã€‚</li>
</ol>
</li>
<li><p>æ©ç </p>
<ol>
<li>æ©ç å€¼å¿…é¡»æ˜¯éšæœºçš„32-bitå€¼</li>
<li>æ©ç å€¼å¹¶ä¸ä¼šå½±å“Payload dataçš„é•¿åº¦ã€‚</li>
<li>æ©ç ç®—æ³•ï¼šæ©ç åçš„ç¬¬iå­—èŠ‚æ•°æ® = æ©ç å‰çš„ç¬¬iå­—èŠ‚çš„æ•°æ® XOR æ©ç keyçš„ç¬¬ï¼ˆi mod 4ï¼‰å­—èŠ‚çš„æ•°æ®</li>
</ol>
</li>
</ol>
<h3 id="SocketRocketæºç è§£æ"><a href="#SocketRocketæºç è§£æ" class="headerlink" title="SocketRocketæºç è§£æ"></a>SocketRocketæºç è§£æ</h3><ol start="0">
<li><p>è¾…åŠ©ç±»ç®€å•è¯´æ˜</p>
<ol>
<li><text>_SRRunLoopThread</text>: æ‰¿è½½å’Œå¤„ç†æ‰€æœ‰äº‹ä»¶çš„çº¿ç¨‹ã€‚é€šè¿‡<code>NSRunLoop (SRWebSocket)</code>æŠŠè¿™ä¸ªçº¿ç¨‹æ”¾åˆ°äº†RunLoopé‡Œã€‚å¹¶ä¸”åœ¨<code>- (void)main</code>ä¸­ä½¿ç”¨ä¸€ä¸ªwhileå¾ªç¯ä½¿è¿™ä¸ªçº¿ç¨‹æ­£å¸¸æƒ…å†µä¸‹æ°¸ä¸åœæ­¢ã€‚</li>
<li>SRIOConsumerå’ŒSRIOConsumerPool: ç”¨æ¥å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯ã€‚</li>
</ol>
</li>
<li><p>ä¸»è¦æ–¹æ³•è¯´æ˜</p>
<ol>
<li><p><code>- (id)initWithURLRequest:(NSURLRequest *)request protocols:(NSArray *)protocols allowsUntrustedSSLCertificates:(BOOL)allowsUntrustedSSLCertificates</code> åŸºæœ¬åˆå§‹åŒ–æ–¹æ³•ã€‚åˆå§‹åŒ–äº†SRSocketç±»å†…çš„å‡ ä¸ªæˆå‘˜å˜é‡ã€‚</p>
</li>
<li><p><code>_SR_commonInit</code></p>
<ol>
<li>åˆ¤æ–­åè®®ç±»å‹</li>
<li>åˆå§‹åŒ–äº†_workQueueï¼Œè¿™ä¸ªGCDé˜Ÿåˆ—ç”¨æ¥å¤„ç†ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬å¤„ç†é”™è¯¯ã€å‘é€å†…å®¹ã€å…³é—­è¿æ¥ç­‰ã€‚</li>
<li>åˆå§‹åŒ–_delegateDispatchQueueï¼Œè¿™ä¸ªé˜Ÿåˆ—æ˜¯ç”¨æ¥å‘å¤–å‘é€é€šçŸ¥çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>- (void)setDelegateOperationQueue:(NSOperationQueue*) queue</code>æˆ–<code>- (void)setDelegateDispatchQueue:(dispatch_queue_t) queue</code>æ¥è‡ªå®šä¹‰è¿™ä¸ªé˜Ÿåˆ—ã€‚</li>
</ol>
</li>
<li><p><code>_initializeStreams</code> åˆ›å»ºè¾“å…¥/å‡ºæµ</p>
</li>
<li><p><code>open</code>/<code>openConnection</code> è¿™ä¸¤ä¸ªæ–¹æ³•å’Œè¢«ä»–ä»¬è°ƒç”¨çš„æ–¹æ³•æ˜¯ç”¨æ¥é…ç½®å¹¶æ‰“å¼€æµçš„</p>
</li>
<li><p><code>didConnect</code></p>
<ol>
<li>æ„å»ºHTTP Header</li>
<li>å‘é€HTTP Header</li>
<li>æ³¨å†Œä¸€ä¸ªæ¥æ”¶æœåŠ¡å™¨è¿”å›Headerä¿¡æ¯çš„ç›‘å¬ï¼Œå¹¶åœ¨å›è°ƒå†…è¿›è¡Œç›¸åº”å¤„ç†</li>
</ol>
</li>
<li><p><code>- (void)safeHandleEvent:(NSStreamEvent)eventCode stream:(NSStream *)aStream</code></p>
<ol>
<li>è¿™æ˜¯NSStreamçš„å›è°ƒæ–¹æ³•ï¼Œè¾“å…¥å’Œè¾“å‡ºæµçš„å…±åŒå›è°ƒ</li>
<li><code>NSStreamEventOpenCompleted</code> è¿æ¥æ‰“å¼€ï¼›<code>NSStreamEventHasBytesAvailable</code> å¯è¯»å–ï¼›<code>NSStreamEventHasSpaceAvailable</code> å¯å†™å…¥æ•°æ®</li>
<li>åœ¨<code>NSStreamEventOpenCompleted</code>é‡Œé¢çš„<code>[self _pumpScanner];</code>ç”¨æ¥è§¦å‘ç¬¬5æ¡ä¸­çš„3ï¼Œæ¥å¤„ç†æœåŠ¡å™¨è¿”å›çš„æ¡æ‰‹Headerä¿¡æ¯</li>
</ol>
</li>
<li><p><code>_pumpWriting</code></p>
<ol>
<li>å‘è¾“å‡ºæµå†™æ•°æ®<code>[_outputStream write:_outputBuffer.bytes + _outputBufferOffset maxLength:dataLength - _outputBufferOffset]</code></li>
<li><code>if (_outputBufferOffset &gt; 4096 &amp;&amp; _outputBufferOffset &gt; (_outputBuffer.length &gt;&gt; 1)) &#123; _outputBuffer = [[NSMutableData alloc] initWithBytes:(char *)_outputBuffer.bytes + _outputBufferOffset length:_outputBuffer.length - _outputBufferOffset]; _outputBufferOffset = 0; &#125;</code> å½“ç¼“å­˜è¶…è¿‡4Mæ—¶æ¸…ç©º</li>
</ol>
</li>
<li><p><code>- (void)_sendFrameWithOpcode:(SROpCode)opcode data:(id)data</code> æŠŠæ•°æ®ç»„è£…æˆç¬¦åˆåè®®è¦æ±‚çš„æ ¼å¼ã€‚å‚è€ƒâ€œæ•°æ®å¸§æ ¼å¼â€çš„å›¾ç‰‡ã€‚</p>
<ol>
<li>å‘frame_bufferä¸­å†™å…¥fin/opcodeå­—æ®µ</li>
<li>å†™å…¥maskå­—æ®µ</li>
<li>æ ¹æ®è¦å‘é€çš„æ•°æ®å¾—åˆ°æœªæ©ç æ•°æ®<code>unmasked_payload</code></li>
<li>ä½¿ç”¨<code>int SecRandomCopyBytes(SecRandomRef rnd, size_t count, void *bytes);</code>å¾—åˆ°æ©ç key<code>mask_key</code></li>
<li>æ ¹æ®mask_keyå’Œunmasked_payloadå¾—åˆ°æ©ç åæ•°æ®å¹¶åˆ‡å…¥frame_buffer</li>
</ol>
</li>
<li><p><code>_HTTPHeadersDidFinish</code> å¤„ç†æœåŠ¡å™¨è¿”å›çš„æ¡æ‰‹ä¿¡æ¯ã€‚é€šè¿‡å¯¹æœåŠ¡å™¨è¿”å›çš„æ¡æ‰‹ä¿¡æ¯çš„åˆ†ææ¥åˆ¤æ–­è¿æ¥æ˜¯å¦æˆåŠŸæ‰“å¼€ã€‚</p>
</li>
<li><p><code>_innerPumpScanner</code> å¤„ç†æ”¶åˆ°çš„æ•°æ®ï¼Œè¯»å–æœªè¯»æ•°æ®ï¼Œå¹¶ä¸”æŠŠæœªè¯»æ•°æ®é€šè¿‡<code>consumer.handler(self, slice);</code>è¿”å›ç»™consumeræ¥è§£ææ•°æ®å†…å®¹ã€‚</p>
</li>
<li><p><code>- (void)_handleFrameWithData:(NSData *)frameData opCode:(NSInteger)opcode</code> æ ¹æ®opCodeå¯¹æ”¶åˆ°çš„æ•°æ®è¿›è¡Œåˆ†ç±»å¤„ç†</p>
</li>
<li><p><code>- (void)_readFrameContinue</code> è¿™ä¸ªæ˜¯ä¸»è¦çš„æ•°æ®å¤„ç†æ–¹æ³•ã€‚æ•´ä¸ªæ•°æ®ç»“æ„çš„å¤„ç†çš„è¿‡ç¨‹å°±æ˜¯æŒ‰ç…§WebSocketåè®®çš„è§„å®šæ¥çš„ã€‚</p>
</li>
</ol>
</li>
</ol>
<p>åˆ°æ­¤ï¼ŒSocketRocketçš„æºç åˆ†æå°±ç»“æŸäº†ã€‚å…¶ä¸­ä¸€äº›åœ°æ–¹è¯´çš„æ¯”è¾ƒå•°å—¦ï¼Œæœ‰äº›åœ°æ–¹è¯´çš„å¯èƒ½ä¸å¤Ÿè¯¦ç»†ã€‚å¤§å®¶åœ¨çœ‹æºç çš„æ—¶å€™ä¸€å®šè¦å¯¹ç…§ç€WebSocketçš„åè®®å†…å®¹ã€‚å¦‚æœæœ‰ä¸æ¸…æ¥šçš„åœ°æ–¹æ¬¢è¿å’¨è¯¢ã€‚æœ‰è¯´çš„ä¸å¯¹çš„åœ°æ–¹ä¹Ÿæ¬¢è¿æŒ‡æ­£ã€‚<br></p>
<p>ç¥ä½ æ—©æ—¥èµ°ä¸Šäººç”Ÿå·…å³°!!!</p>
<h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2017/05/websocket.html">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a><br><br><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/20215561">çŸ¥ä¹</a><br><br><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc6455">RFC6455 WebSocket Protocol</a></p>
<div><h1>æ¨èæ–‡ç« <span style="font-size:0.45em; color:gray"></span></h1><ul><li><a href="http://www.iosprogrammer.tech/how-to-make-view-get-intrinsic-content-size/">æœ€ä½³å®è·µï¼šiOSå¼€å‘åœ¨xib/storyboardä¸­è‡ªå®šä¹‰view</a></li><li><a href="http://www.iosprogrammer.tech/What-is-Content-Hugging-Priorities-Content-Compression-Resistance-Priorities/">ä»€ä¹ˆæ˜¯Content Hugging Priorities/Content Compression Resistance Priorities</a></li><li><a href="http://www.iosprogrammer.tech/UIStackView-Advanced-Knowledge/">UIStackViewçš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ï¼ˆæœ€æ–°æœ€å…¨ã€é…è§†é¢‘æ•™ç¨‹ï¼‰</a></li></ul></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.iosprogrammer.tech/Calendar-Notes-Reminders/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="æ–½æ²»æ˜‚">
      <meta itemprop="description" content="åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="iOSå¼€å‘æ ˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Calendar-Notes-Reminders/" class="post-title-link" itemprop="url">Mac OS/iOSä¸­æ—¥å†ã€å¤‡å¿˜å½•ã€æé†’äº‹é¡¹çš„ä½¿ç”¨ä»¥åŠä½¿ç”¨iMessageå…±äº«å±å¹•</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-05-26 14:40:15" itemprop="dateCreated datePublished" datetime="2018-05-26T14:40:15+08:00">2018-05-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-01-21 13:38:01" itemprop="dateModified" datetime="2021-01-21T13:38:01+08:00">2021-01-21</time>
      </span>

  
    <span id="/Calendar-Notes-Reminders/" class="post-meta-item leancloud_visitors" data-flag-title="Mac OS/iOSä¸­æ—¥å†ã€å¤‡å¿˜å½•ã€æé†’äº‹é¡¹çš„ä½¿ç”¨ä»¥åŠä½¿ç”¨iMessageå…±äº«å±å¹•" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span class="leancloud-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>æ—¢ç„¶èŠ±äº†ä¸Šä¸‡å…ƒä¹°äº†ä¸€å°è‹¹æœçš„è®¾å¤‡å°±è¦å¥½å¥½åˆ©ç”¨ã€‚æœ¬ç¯‡æ–‡ç« è®©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹iPhone/Macè‡ªå¸¦çš„å‡ ä¸ªAPPçš„ä½¿ç”¨ã€‚</p>
<h2 id="ä¸€-æ—¥å†"><a href="#ä¸€-æ—¥å†" class="headerlink" title="ä¸€. æ—¥å†"></a>ä¸€. æ—¥å†</h2><p>è¿™éƒ¨åˆ†æˆ‘ç›´æ¥ç”¨ç”µè„‘ä¸Šçš„æˆªå›¾ï¼Œå’Œæ‰‹æœºä¸Šçš„æ˜¯ä¸€æ ·çš„ä¸ç”¨æ‹…å¿ƒã€‚<br><br><strong>æ—¥å¸¸ä½¿ç”¨</strong>ï¼šæˆ‘ä»¬å­¦æ ¡çš„è¯¾ç¨‹è¡¨æ˜¯å¤–åŒ…ç»™ä¸€ä¸ªç§‘æŠ€å…¬å¸ï¼Œå¯ä»¥è‡ªåŠ¨å¯¼å…¥æ—¥å†çš„ï¼Œå®‰å“çš„ä¹Ÿå¯ä»¥ã€‚å¦‚æœå…¶ä»–æœ‹å‹æ²¡æœ‰è¿™ç§æœåŠ¡çš„è¯ï¼Œéœ€è¦æ·»åŠ è¯¾ç¨‹è¡¨çš„è¯å°±çœ‹çœ‹æœ‰æ²¡æœ‰ç‰¹æ®Šçš„è½¯ä»¶å¯ä»¥å¯¼å…¥ã€‚å®åœ¨ä¸è¡Œå°±æ‰‹åŠ¨å¯¼å…¥äº†ï¼Œæ—¥ç¨‹æ˜¯å¯ä»¥è®¾ç½®å¾ªç¯å‘¨æœŸçš„ã€‚<br><img src="http://image.iosprogrammer.hongbility.com/Calendar-Notes-Reminders/calendar-1.jpg" alt="è¯¾è¡¨"><br><strong>å›¢é˜Ÿåä½œ</strong>ï¼šæ¯”å¦‚æˆ‘ä¼šç»™æˆ‘åŒäº‹å‘æ—¥å†ï¼Œå¼€ä¼šæ—¶é—´ï¼Œå¹¶ä¸”è®¾ç½®äº†æå‰ä¸€å¤©å’Œæå‰6å°æ—¶æé†’ï¼Œæ€•æœ‰äº›äººä¼šå¿˜è®°= =ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦æŠŠåŒäº‹ä»¬çš„ç»‘å®šiCloudçš„æ‰‹æœºå·/é‚®ç®±åœ°å€å­˜å…¥é€šè®¯å½•ä¸­ï¼Œæ·»åŠ åå­—çš„æ—¶å€™ç›´æ¥è¾“å…¥å‚åŠ ä¼šè®®çš„æˆå‘˜åå­—ï¼Œå¯¹æ–¹å³å¯æ”¶åˆ°é€šçŸ¥ï¼ˆå‰ææ˜¯å¯¹æ–¹æ‰“å¼€äº†æ—¥å†çš„é€šçŸ¥ï¼‰<br><img src="http://image.iosprogrammer.hongbility.com/Calendar-Notes-Reminders/calendar-2.jpg" alt="å›¢é˜Ÿåä½œ"><br><strong>æ—¶é—´ç®¡ç†</strong>çš„å¥½ä¹ æƒ¯ï¼šæˆ‘æ”¾å‡å›å®¶å’ŒåŒå­¦é¢‘ç¹èšé¤çº¦é¥­ï¼Œæˆ‘ç”šè‡³æŠŠæ¯é¡¿é¥­æ—¶é—´åœ°ç‚¹äººç‰©æå‰å†™åœ¨æ—¥å†ä¸Šæé†’è‡ªå·±ï¼ˆå¯¹ï¼Œæˆ‘åŸºæœ¬ä¸æ”¾äººå®¶é¸½å­ï¼Œç­”åº”çš„äº‹æƒ…é™¤éå¤©å¡Œä¸‹æ¥æ‰ä¼šçˆ½çº¦ï¼‰<br><img src="http://image.iosprogrammer.hongbility.com/Calendar-Notes-Reminders/calendar-3.jpg"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/Calendar-Notes-Reminders/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.iosprogrammer.tech/Submit-Domain-To-Baidu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="æ–½æ²»æ˜‚">
      <meta itemprop="description" content="åˆ†äº«iOSå¼€å‘çŸ¥è¯†ï¼ŒObjective-Cã€Swiftã€Xcodeç›¸å…³æŠ€å·§">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="iOSå¼€å‘æ ˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Submit-Domain-To-Baidu/" class="post-title-link" itemprop="url">æŠŠåŸŸåæäº¤åˆ°ç™¾åº¦èµ„æºå¹³å°</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-05-24 17:52:19" itemprop="dateCreated datePublished" datetime="2018-05-24T17:52:19+08:00">2018-05-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">æ›´æ–°äº</span>
        <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-01-21 13:39:04" itemprop="dateModified" datetime="2021-01-21T13:39:04+08:00">2021-01-21</time>
      </span>

  
    <span id="/Submit-Domain-To-Baidu/" class="post-meta-item leancloud_visitors" data-flag-title="æŠŠåŸŸåæäº¤åˆ°ç™¾åº¦èµ„æºå¹³å°" title="é˜…è¯»æ¬¡æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span class="leancloud-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ä¸Šä¸€ç¯‡<a href="http://www.iosprogrammer.tech/deploy-hexo-to-gitlab/">åšå®¢</a>è®²äº†æ€ä¹ˆæŠŠHexoåšå®¢éƒ¨ç½²åˆ°Gitlabã€‚</p>
<h3 id="æœ¬æ–‡çš„ç›®çš„"><a href="#æœ¬æ–‡çš„ç›®çš„" class="headerlink" title="æœ¬æ–‡çš„ç›®çš„"></a>æœ¬æ–‡çš„ç›®çš„</h3><p>ä½œä¸ºä¸€ä¸ªå¼€å‘è€…å†™åšå®¢çš„ç›®çš„é™¤äº†è®°å½•çŸ¥è¯†å’Œè‡ªå·±çš„æƒ³æ³•å¤–å°±æ˜¯åˆ†äº«ã€‚è¦æŠŠæˆ‘ä»¬çš„åšå®¢åˆ†äº«å‡ºå»æœ€å¥½çš„åŠæ³•å°±æ˜¯è®©å…¶ä»–äººå¯ä»¥é€šè¿‡æœç´¢å¼•æ“æŸ¥æ‰¾åˆ°ã€‚</p>
<p>é‚£ä¹ˆæ€ä¹ˆè®©å¦‚æ­¤å¿™ç¢Œçš„æœç´¢å¼•æ“çŸ¥é“å’±ä»¬å‘¢ï¼Ÿå…¶å®æ¯ä¸€ä¸ªæœç´¢å¼•æ“éƒ½æœ‰ä¸€ä¸ªè®©å¹¿å¤§ç«™é•¿ä»¬æäº¤é“¾æ¥çš„åœ°æ–¹ï¼Œæ¯”å¦‚<a target="_blank" rel="noopener" href="https://ziyuan.baidu.com/">ç™¾åº¦èµ„æºå¹³å°</a>ã€‚</p>
<p>ä¸‹é¢è·Ÿç€æˆ‘æ¥æŠŠåšå®¢æäº¤åˆ°ç™¾åº¦å§ã€‚</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/Submit-Domain-To-Baidu/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æ–½æ²»æ˜‚</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  






  


<script data-pjax>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      const visitors = document.querySelector('.leancloud_visitors');
      const url = decodeURI(visitors.id);
      const title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            const counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      const visitors = document.querySelectorAll('.leancloud_visitors');
      const entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            const target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    const { app_id, app_key, server_url } = {"enable":true,"app_id":"ENF98d3lY1q1PN1nHaX8tLzX-gzGzoHsz","app_key":"gVbfqVHqQAnAqFM6hVRLrPJT","server_url":null,"security":true};
    function fetchData(api_server) {
      const Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    const api_server = app_id.slice(-9) === '-MdYXbMMI' ? `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com` : server_url;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>

    <div class="pjax">

  


    </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
