<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>不务正业的程序员</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="iOS,iOS开发技术,Objective-C,Swift,Cocoa">
<meta property="og:type" content="website">
<meta property="og:title" content="不务正业的程序员">
<meta property="og:url" content="http://www.iosprogrammer.tech/page/4/index.html">
<meta property="og:site_name" content="不务正业的程序员">
<meta property="og:description" content="iOS,iOS开发技术,Objective-C,Swift,Cocoa">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="不务正业的程序员">
<meta name="twitter:description" content="iOS,iOS开发技术,Objective-C,Swift,Cocoa">
  
    <link rel="alternate" href="/atom.xml" title="不务正业的程序员" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">不务正业的程序员</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">爱编程的大头（公众号同名）</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.iosprogrammer.tech"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Submit-Domain-To-Baidu" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Submit-Domain-To-Baidu/" class="article-date">
  <time datetime="2018-05-24T09:52:19.000Z" itemprop="datePublished">2018-05-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/其他/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Submit-Domain-To-Baidu/">把域名提交到百度资源平台</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上一篇<a href="http://www.iosprogrammer.tech/deploy-hexo-to-gitlab/">博客</a>讲了怎么把Hexo博客部署到Gitlab。</p>
<h3 id="本文的目的"><a href="#本文的目的" class="headerlink" title="本文的目的"></a>本文的目的</h3><p>作为一个开发者写博客的目的除了记录知识和自己的想法外就是分享。要把我们的博客分享出去最好的办法就是让其他人可以通过搜索引擎查找到。</p>
<p>那么怎么让如此忙碌的搜索引擎知道咱们呢？其实每一个搜索引擎都有一个让广大站长们提交链接的地方，比如<a href="https://ziyuan.baidu.com" target="_blank" rel="noopener">百度资源平台</a>。</p>
<p>下面跟着我来把博客提交到百度吧。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="向百度提交域名"><a href="#向百度提交域名" class="headerlink" title="向百度提交域名"></a>向百度提交域名</h4><ol>
<li>打开<a href="https://ziyuan.baidu.com" target="_blank" rel="noopener">百度资源平台</a>并注册/登录百度账号。</li>
<li>打开<a href="https://ziyuan.baidu.com/site/index" target="_blank" rel="noopener">用户中心的站点管理页面</a></li>
<li>填写要添加的站点<img src="http://image.iosprogrammer.hongbility.com/Submit-Domain-To-Baidu/add-site-input.png" alt><blockquote>
<p>建议以www开头</p>
</blockquote>
</li>
<li>根据实际情况选择站点属性。最多选择3个且30天只能修改一次。</li>
<li>验证网站所有权<img src="http://image.iosprogrammer.hongbility.com/Submit-Domain-To-Baidu/add-set-owner.png" alt> <blockquote>
<p>我使用的是CNAME验证，在阿里云配置CNAME<img src="http://image.iosprogrammer.hongbility.com/Submit-Domain-To-Baidu/add-site-owner-cname.png" alt></p>
</blockquote>
</li>
</ol>
<h4 id="向百度提交链接"><a href="#向百度提交链接" class="headerlink" title="向百度提交链接"></a>向百度提交链接</h4><ol>
<li>打开<a href="https://ziyuan.baidu.com/linksubmit/index" target="_blank" rel="noopener">提交链接</a></li>
<li>提交方式分为自动提交和主动提交两大类，自动提交又分成主动推送、自动推送、sitemap三类。<blockquote>
<p>1、主动推送：最为快速的提交方式，推荐您将站点当天新产出链接立即通过此方式推送给百度，以保证新链接可以及时被百度收录。<br><br>2、自动推送：最为便捷的提交方式，请将自动推送的JS代码部署在站点的每一个页面源代码中，部署代码的页面在每次被浏览时，链接会被自动推送给百度。可以与主动推送配合使用。 <br><br>3、sitemap：您可以定期将网站链接放到sitemap中，然后将sitemap提交给百度。百度会周期性的抓取检查您提交的sitemap，对其中的链接进行处理，但收录速度慢于主动推送。 <br><br>4、手动提交：一次性提交链接给百度，可以使用此种方式。<br><br><br>效率比较：主动推送 &gt; 自动推送 &gt; sitemap</p>
</blockquote>
</li>
<li><p>主动推送</p>
<ol>
<li>安装插件<code>npm install hexo-baidu-url-submit --save</code></li>
<li><p>在博客的根目录中新增字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 提交链接给百度 主动推送</span><br><span class="line">baidu_url_submit:</span><br><span class="line"> 	count: 100 # 提交最新的一个链接</span><br><span class="line"> 	host: www.iosprogrammer.tech # 在百度站长平台中注册的域名</span><br><span class="line"> 	token: xxxxx # 请注意这是您的秘钥， 所以请不要把博客源代码发布在公众仓库里!</span><br><span class="line"> 	path: baidu_urls.txt # 文本文档的地址， 新链接会保存在此文本文档里</span><br></pre></td></tr></table></figure>
</li>
<li><p>在博客的根目录中加入新的deploy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">	- type:baidu_url_submitter</span><br></pre></td></tr></table></figure>
</li>
<li><p>验证一下public/baidu_url.txt文件中的链接域名是不是正确。 </p>
</li>
<li>执行<code>hexo deploy</code>的时候，新的链接就会被推送了</li>
</ol>
</li>
<li><p>自动推送</p>
<ol>
<li><p>在博客的主题配置中（如thmes/next/_config.ymml）将baidu_push设置为true</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO</span><br><span class="line">baidu_push: true</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看thems/next/layout_scripts/baidu_push.swig文件是否存在，如果不存在就创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.baidu_push %&#125;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">(function()&#123;</span><br><span class="line">   	var bp = document.createElement(&apos;script&apos;);</span><br><span class="line">   	var curProtocol = window.location.protocol.split(&apos;:&apos;)[0];</span><br><span class="line">   	if (curProtocol === &apos;https&apos;) &#123;</span><br><span class="line">       	bp.src = &apos;https://zz.bdstatic.com/linksubmit/push.js&apos;;</span><br><span class="line">   	&#125;</span><br><span class="line">   	else &#123;</span><br><span class="line">       	bp.src = &apos;http://push.zhanzhang.baidu.com/push.js&apos;;</span><br><span class="line">   	&#125;</span><br><span class="line">   	var s = document.getElementsByTagName(&quot;script&quot;)[0];</span><br><span class="line">   	s.parentNode.insertBefore(bp, s);</span><br><span class="line">&#125;)();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果有人打开了页面就会把相应的链接推给百度。</p>
</li>
</ol>
</li>
</ol>
<h3 id="执行一次hexo-deploy。链接提交到百度以后需要等几天才能被收录。可以通过site-你提交到百度的链接查看是否被收录，也可以到百度资源平台查看"><a href="#执行一次hexo-deploy。链接提交到百度以后需要等几天才能被收录。可以通过site-你提交到百度的链接查看是否被收录，也可以到百度资源平台查看" class="headerlink" title="执行一次hexo deploy。链接提交到百度以后需要等几天才能被收录。可以通过site:你提交到百度的链接查看是否被收录，也可以到百度资源平台查看"></a>执行一次<code>hexo deploy</code>。链接提交到百度以后需要等几天才能被收录。可以通过<code>site:你提交到百度的链接</code>查看是否被收录，也可以到<a href="http://ziyuan.baidu.com" target="_blank" rel="noopener">百度资源平台</a>查看</h3><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a href="https://blog.csdn.net/sunshine940326/article/details/70936988" target="_blank" rel="noopener">hexo高阶教程：想让你的博客被更多的人在搜索引擎中搜到吗？</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.iosprogrammer.tech/Submit-Domain-To-Baidu/" data-id="ckcezpvjr000okcs66d5n32lj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-deploy-hexo-to-gitlab" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/deploy-hexo-to-gitlab/" class="article-date">
  <time datetime="2018-05-11T09:36:01.000Z" itemprop="datePublished">2018-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/其他/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/deploy-hexo-to-gitlab/">hexo博客进阶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="部署Hexo到Gitlab"><a href="#部署Hexo到Gitlab" class="headerlink" title="部署Hexo到Gitlab"></a>部署Hexo到Gitlab</h1><ul>
<li>Hexo + GtHub：起初想要把这个博客放到Github上，但是由于Github不让百度爬取。</li>
<li>Hexo + Coding.net：后来又尝试了 coding.net，在使用coding.net的过程中遇到了一些坑。<ul>
<li>普通会员不能自定义域名 -&gt; 申请成为白银会员（使用腾讯云授权）</li>
<li>微信等方式登录腾讯云后，授权失败（不知原因） -&gt; 使用腾讯云直接登录 -&gt; 授权成功，成为白银会员，可以自定义域名</li>
<li>首次打开会显示5s的coding.net广告，后跳转到博客，据说这样的话无法被百度收录 -&gt; 充值199/年 成为黄金会员（我没有充）</li>
</ul>
</li>
</ul>
<h3 id="Hexo-Gitlab"><a href="#Hexo-Gitlab" class="headerlink" title="Hexo + Gitlab"></a>Hexo + Gitlab</h3><ol>
<li>在原来的博客根目录中新建一个<code>.gitlab-ci.yml</code>：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">before_script:</span><br><span class="line">  - apt-get update -qq &amp;&amp; apt-get install -y -qq pandoc</span><br><span class="line">image: node:9.8.0</span><br><span class="line">pages:</span><br><span class="line">  cache:</span><br><span class="line">    paths:</span><br><span class="line">    - node_modules/</span><br><span class="line">  script:</span><br><span class="line">  - npm install hexo-cli -g</span><br><span class="line">  - npm install</span><br><span class="line">  - hexo deploy</span><br><span class="line">  artifacts:</span><br><span class="line">    paths:</span><br><span class="line">    - public</span><br><span class="line">  only:</span><br><span class="line">  - master</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>这里需要注意，<strong>image: node:9.8.0</strong> node的版本 <strong><em>不是2.2.0</em></strong>，9.8.0这个版本是我当前安装的版本，其他的版本我没有试过。</p>
</blockquote>
<ol>
<li><p>在博客的根目录的配置文件<code>_config.yml</code>中，把deploy下推送到github的相关内容删掉。这是因为在gitlab的自动部署过程中会执行推送github的操作，为了不用配置用户名和密码相关配置，建议删除。</p>
</li>
<li><p>在gitlab中新建仓库，过程省略。</p>
</li>
<li><p>把博客内容push到上一步新建的仓库中，过程省略。</p>
</li>
<li><p>查看gitlab中项目的CI/CD -&gt; Piplines，这时候应该处于Padding状态，等几分钟，状态变成了Success。<br><img src="http://image.iosprogrammer.hongbility.com/deploy-hexo-to-gitlab-CI:CD.png" alt></p>
</li>
<li><p>查看Setting -&gt; Pages可以看到gitlab给我们分配的链接，访问链接可以看到我们的博客。</p>
</li>
</ol>
<p>部署到gitlab成功 🎉🎉🎉</p>
<h3 id="自定义域名"><a href="#自定义域名" class="headerlink" title="自定义域名"></a>自定义域名</h3><p>Setting -&gt; Pages页面中可以通过NewDomain来自定义域名<br><img src="http://image.iosprogrammer.hongbility.com/deploy-hexo-to-gitlab/pages.png" alt="pages"><br>如果你的域名不支持HTTPS请不要勾选<code>Force domain with SSL...</code>点击<code>New domain</code>可以添加指定域名，添加域名后会看到如下页面：<br><img src="http://image.iosprogrammer.hongbility.com/deploy-hexo-to-gitlab/domain.png" alt="domain"><br>上图中绿色的<code>verified</code>是因为我已经验证完成了，如果没有验证完成应该是黄色的。验证过程为分别在云服务商处添加CNAME和TXT域名解析，因为我使用的是阿里云服务器，下面贴出来阿里云上的解析结果：<br><img src="http://image.iosprogrammer.hongbility.com/deploy-hexo-to-gitlab/DNS.png" alt="DNS"><br>其中TXT解析的内容就是<code>Verifycation status</code>的内容。<br>CNAME和TXT解析设置完成后需要等几分钟才会生效，生效后可以在本地电脑的终端中查看结果，正确的结果如下：<br><img src="http://image.iosprogrammer.hongbility.com/deploy-hexo-to-gitlab/dns-result.png" alt="dns-result"></p>
<p>自定义域名成功 🎉🎉🎉</p>
<h3 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h3><p><img src="http://image.iosprogrammer.hongbility.com/deploy-hexo-to-gitlab/success.png" alt="success"></p>
<h1 id="hexo中插入数学公式"><a href="#hexo中插入数学公式" class="headerlink" title="hexo中插入数学公式"></a>hexo中插入数学公式</h1><blockquote>
<p>原生hexo并不支持数学公式，需要安装插件<a href="https://www.mathjax.org/" target="_blank" rel="noopener">mathJax</a>。<a href="https://www.mathjax.org/" target="_blank" rel="noopener">mathJax</a>是一款运行于浏览器中的开源数学符号渲染引擎，使用 mathJax 可以方便的在浏览器中嵌入数学公式。mathJax 使用网络字体产生高质量的排版，因此可适应各种分辨率，它的显示是基于文本的而非图片，因此显示效果更好。这些公式可以被搜索引擎使用，因此公式里的符号一样可以被搜索引擎检索到。</p>
</blockquote>
<h2 id="安装与配置"><a href="#安装与配置" class="headerlink" title="安装与配置"></a>安装与配置</h2><ol>
<li><code>$ npm install hexo-math --save</code><br>在站点配置文件 _config.yml 中添加：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">math:</span><br><span class="line">  engine: &apos;mathjax&apos; # or &apos;katex&apos;</span><br><span class="line">  mathjax:</span><br><span class="line">    # src: custom_mathjax_source</span><br><span class="line">    config:</span><br><span class="line">      # MathJax config</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在 next 主题配置文件中 themes/next-theme/_config.yml 中将 mathJax 设为 true:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># MathJax Support</span><br><span class="line">mathjax:</span><br><span class="line">  enable: true</span><br><span class="line">  per_page: false</span><br><span class="line">  cdn: //cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MM</span><br></pre></td></tr></table></figure></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>公式插入格式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$数学公式$ 行内 不独占一行</span><br><span class="line">$$数学公式$$ 行间 独占一行</span><br></pre></td></tr></table></figure></p>
<p>例如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$f(x)=ax+b$</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：f(x)=ax+b<br>如果是行间则使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$$f(x)=ax+b$$</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：<br>$$f(x)=ax+b$$</p>
<h3 id="语法格式"><a href="#语法格式" class="headerlink" title="语法格式"></a>语法格式</h3><h4 id="上标与下标"><a href="#上标与下标" class="headerlink" title="上标与下标"></a>上标与下标</h4><p>使用 ^ 表示上标，使用 _ 表示下标，如果上下标的内容多于一个字符，可以使用大括号括起来：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$$f(x) = a_1x^n + a_2x^&#123;n-1&#125; + a_3x^&#123;n-2&#125;$$</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：<br>$$f(x) = a_1x^n + a_2x^{n-1} + a_3x^{n-2}$$<br>如果左右两边都有上下标可以使用 \sideset 语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$$\sideset&#123;^n_k&#125;&#123;^x_y&#125;a$$</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：<br>$$\sideset{^n_k}{^x_y}a$$</p>
<h4 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h4><p>在 markdown 语法中，\, $, {, }, _都是有特殊含义的，所以需要加\转义。小括号与方括号可以使用原始的() [] 大括号需要转义\也可以使用\lbrace和 \rbrace<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\&#123;x*y\&#125;</span><br><span class="line">\lbrace x*y \rbrace</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：{x*y}<br>原始符号不会随着公式大小自动缩放，需要使用 \left 和 \right 来实现自动缩放：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$$\left \lbrace \sum_&#123;i=0&#125;^n i^3 = \frac&#123;(n^2+n)(n+6)&#125;&#123;9&#125; \right \rbrace$$</span><br></pre></td></tr></table></figure></p>
<p>效果：$$\left \lbrace \sum_{i=0}^n i^3 = \frac{(n^2+n)(n+6)}{9} \right \rbrace$$<br>不使用\left 和 \right的效果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$$ \lbrace \sum_&#123;i=0&#125;^n i^3 = \frac&#123;(n^2+n)(n+6)&#125;&#123;9&#125;  \rbrace$$</span><br></pre></td></tr></table></figure></p>
<p>$$ \lbrace \sum_{i=0}^n i^3 = \frac{(n^2+n)(n+6)}{9}  \rbrace$$</p>
<h4 id="分数与开方"><a href="#分数与开方" class="headerlink" title="分数与开方"></a>分数与开方</h4><p>可以使用\frac 或者 \over 实现分数的显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$\frac xy$</span><br><span class="line">$ x+3 \over y+5 $</span><br></pre></td></tr></table></figure></p>
<p>分别显示为：$\frac xy$和$ x+3 \over y+5 $<br>开方使用\sqrt:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ \sqrt&#123;x^5&#125; $</span><br><span class="line">$ \sqrt[3]&#123;\frac xy&#125; $</span><br></pre></td></tr></table></figure></p>
<p>分别显示为：$ \sqrt{x^5} $和$ \sqrt[3]{\frac xy} $</p>
<h4 id="求和与积分"><a href="#求和与积分" class="headerlink" title="求和与积分"></a>求和与积分</h4><p>求和使用\sum,可加上下标，积分使用\int可加上下限，双重积分用\iint:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ \sum_&#123;i=0&#125;^n $</span><br><span class="line">$ \int_1^\infty $</span><br><span class="line">$ \iint_1^\infty $</span><br></pre></td></tr></table></figure></p>
<p>分别显示为：$ \sum_{i=0}^n $和$ \int_1^\infty $以及$ \iint_1^\infty $</p>
<h4 id="极限"><a href="#极限" class="headerlink" title="极限"></a>极限</h4><p>极限使用\lim:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ \lim_&#123;x \to 0&#125; $</span><br></pre></td></tr></table></figure></p>
<p>显示为：$ \lim_{x \to 0} $</p>
<h4 id="表格和矩阵"><a href="#表格和矩阵" class="headerlink" title="表格和矩阵"></a>表格和矩阵</h4><p>表格样式lcr表示居中，|加入一条竖线，\hline表示行间横线，列之间用&amp;分隔，行之间用\分隔<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$$\begin&#123;array&#125;&#123;c|lcr&#125;</span><br><span class="line">n &amp; \text&#123;Left&#125; &amp; \text&#123;Center&#125; &amp; \text&#123;Right&#125; \\\\</span><br><span class="line">\hline</span><br><span class="line">1 &amp; 1.97 &amp; 5 &amp; 12 \\\\</span><br><span class="line">2 &amp; -11 &amp; 19 &amp; -80 \\\\</span><br><span class="line">3 &amp; 70 &amp; 209 &amp; 1+i \\\\</span><br><span class="line">\end&#123;array&#125;$$</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：<br>$$\begin{array}{c|lcr}<br>n &amp; \text{Left} &amp; \text{Center} &amp; \text{Right} \\<br>\hline<br>1 &amp; 1.97 &amp; 5 &amp; 12 \\<br>2 &amp; -11 &amp; 19 &amp; -80 \\<br>3 &amp; 70 &amp; 209 &amp; 1+i \\<br>\end{array}$$<br>表格的插入也可以使用以下方式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">名称|说明</span><br><span class="line">---|---|---</span><br><span class="line">temperature|  室内温度</span><br><span class="line">set temperature|  设定温度</span><br><span class="line">height|  室内高度</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：<br>名称|说明<br>—|—|—<br>temperature|  室内温度<br>set temperature|  设定温度<br>height|  室内高度<br>矩阵显示和表格很相似<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$$\left[</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">V_A \\\\</span><br><span class="line">V_B \\\\</span><br><span class="line">V_C \\\\</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right] =</span><br><span class="line">\left[</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">1 &amp; 0 &amp; L \\\\</span><br><span class="line">-cosψ &amp; sinψ &amp; L \\\\</span><br><span class="line">-cosψ &amp; -sinψ &amp; L</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right]</span><br><span class="line">\left[</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">V_x \\\\</span><br><span class="line">V_y \\\\</span><br><span class="line">W \\\\</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\right] $$</span><br></pre></td></tr></table></figure></p>
<p>显示效果为：<br>$$\left[<br>\begin{matrix}<br>V_A \\<br>V_B \\<br>V_C \\<br>\end{matrix}<br>\right] =<br>\left[<br>\begin{matrix}<br>1 &amp; 0 &amp; L \\<br>-cosψ &amp; sinψ &amp; L \\<br>-cosψ &amp; -sinψ &amp; L<br>\end{matrix}<br>\right]<br>\left[<br>\begin{matrix}<br>V_x \\<br>V_y \\<br>W \\<br>\end{matrix}<br>\right] $$</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://www.youtube.com/watch?v=TWqh9MtT4Bg" target="_blank" rel="noopener">gitlab官方youtube视频</a><br><a href="http://stevenshi.me/2017/06/26/hexo-insert-formula/" target="_blank" rel="noopener">Steven Shi的博客</a></p>
<p>👍👍👍</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.iosprogrammer.tech/deploy-hexo-to-gitlab/" data-id="ckcezpvju000skcs64dfxomcl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-iOS-Pull-Live-Stream" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/iOS-Pull-Live-Stream/" class="article-date">
  <time datetime="2018-05-07T08:55:06.000Z" itemprop="datePublished">2018-05-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/直播/">直播</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/iOS-Pull-Live-Stream/">iOS直播APP的开发——拉流</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="播放器：IJKPlayer"><a href="#播放器：IJKPlayer" class="headerlink" title="播放器：IJKPlayer"></a>播放器：IJKPlayer</h3><ul>
<li>github地址：<a href="https://github.com/Bilibili/ijkplayer" target="_blank" rel="noopener">https://github.com/Bilibili/ijkplayer</a></li>
<li>下载、编译过程<ul>
<li>git clone <a href="https://github.com/Bilibili/ijkplayer.git" target="_blank" rel="noopener">https://github.com/Bilibili/ijkplayer.git</a> ijkplayer-ios</li>
<li>cd ijkplayer-ios</li>
<li>git checkout -B latest k0.8.8</li>
<li>./init-ios.sh</li>
<li>cd ios</li>
<li>./compile-ffmpeg.sh clean</li>
<li>./compile-ffmpeg.sh all</li>
</ul>
</li>
<li><p>编译过程中遇到的问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./libavutil/arm/asm.S:50:9: error: unknown directive</span><br><span class="line">        .arch armv7-a</span><br><span class="line">        ^</span><br><span class="line">make: *** [libavcodec/arm/aacpsdsp_neon.o] Error 1</span><br></pre></td></tr></table></figure>
</li>
<li><p>解决：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">最新的 Xcode 已经弱化了对 32 位的支持, 解决方法: 在 compile-ffmpeg.sh 中删除 armv7 , 修改:FF_ALL_ARCHS_IOS8_SDK=&quot;arm64 i386 x86_64&quot; 再重新执行出现错误的命令: ./compile-ffmpeg.sh all</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="获取-framework"><a href="#获取-framework" class="headerlink" title="获取.framework"></a>获取.framework</h3><ol>
<li>打开<code>IJKMediaPlayer.xcodeproj</code></li>
<li>选择真机</li>
<li>切换到Release模式</li>
<li>cmd+B 编译项目</li>
<li>获取/Product目录下的<code>IJKMediaFramework.framework</code>，并拷贝</li>
</ol>
<h3 id="获取rtmp直播流"><a href="#获取rtmp直播流" class="headerlink" title="获取rtmp直播流"></a>获取rtmp直播流</h3><p>我使用charles抓包到《鱼水直播》的推荐列表链接：<a href="http://api.chujianapp.com/live/get_hot_list?app_version=6.3.0&amp;bundle_id=fish.livezb.wte&amp;device=ios&amp;device_id=7ED19CAE-E21F-44BF-98DC-F5346E64E502&amp;device_idfa=51C0FC66-54C0-4F69-91E4-4C168698D1F5&amp;device_model=iPhone%206s&amp;device_version=iOS11.3.1&amp;pkg_channel=ys19&amp;secure_key=bd54628575ff36bd7695519218f6934f&amp;server_upgrade=1&amp;time_stamp=1525858044919&amp;token=18231046%7C227842b7058bc5dad052bc6d8834e68f%7C1525858019&amp;uid=18231046" target="_blank" rel="noopener">http://api.chujianapp.com/live/get_hot_list?app_version=6.3.0&amp;bundle_id=fish.livezb.wte&amp;device=ios&amp;device_id=7ED19CAE-E21F-44BF-98DC-F5346E64E502&amp;device_idfa=51C0FC66-54C0-4F69-91E4-4C168698D1F5&amp;device_model=iPhone%206s&amp;device_version=iOS11.3.1&amp;pkg_channel=ys19&amp;secure_key=bd54628575ff36bd7695519218f6934f&amp;server_upgrade=1&amp;time_stamp=1525858044919&amp;token=18231046%7C227842b7058bc5dad052bc6d8834e68f%7C1525858019&amp;uid=18231046</a><br>从这个链接中可以得到rtmp流</p>
<h3 id="新建一个OC-Demo项目"><a href="#新建一个OC-Demo项目" class="headerlink" title="新建一个OC Demo项目"></a>新建一个OC Demo项目</h3><p>1. 把<code>IJKMediaFramework.framework</code>拷贝到项目目录中</p>
<ol>
<li>在<code>ViewController.m</code>中<code>#import &lt;IJKMediaFramework/IJKFFMoviePlayerController.h&gt;</code>，并且在<code>viewDidLoad</code>中添加如下代码：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NSURL *playerURL = [NSURL URLWithString:@&quot;rtmp:\/\/pili-live-rtmp.chujianapp.com\/ragingfire\/1663091115258475730&quot;];</span><br><span class="line">    IJKFFMoviePlayerController *playerVC = [[IJKFFMoviePlayerController alloc] initWithContentURL:playerURL withOptions:nil];</span><br><span class="line">    [playerVC prepareToPlay];</span><br><span class="line">    playerVC.view.frame = CGRectMake(30, 20, [UIScreen mainScreen].bounds.size.width * 2 / 3, [UIScreen mainScreen].bounds.size.height * 2 / 3);</span><br><span class="line">    playerVC.view.backgroundColor = [UIColor grayColor];</span><br><span class="line">    [self.view insertSubview:playerVC.view atIndex:1];</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h3><p>(o゜▽゜)o☆[BINGO!]</p>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a href="https://www.jianshu.com/p/9743a68c2939" target="_blank" rel="noopener">https://www.jianshu.com/p/9743a68c2939</a></p>
<p>👍👍👍</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.iosprogrammer.tech/iOS-Pull-Live-Stream/" data-id="ckcezpvjw000vkcs6nqoal2su" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Date-And-Time-Three" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Date-And-Time-Three/" class="article-date">
  <time datetime="2018-04-26T09:39:38.000Z" itemprop="datePublished">2018-04-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>►<a class="article-category-link" href="/categories/iOS/日期Date和时间Time/">日期Date和时间Time</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Date-And-Time-Three/">日期Date和时间Time（三）- 一个简单的日历</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在前面两篇中讲到了日期和时间的基础知识，现在让我们来利用学到的基础知识创建一个简单的日历。</p>
<h3 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h3><p><img src="http://image.iosprogrammer.hongbility.com/Date-And-Time-Three/%E6%9C%80%E7%BB%88%E6%95%88%E6%9E%9C.png" alt><br>输入指定的年份和月份后可以得到对应月份的日历。</p>
<h3 id="主要代码"><a href="#主要代码" class="headerlink" title="主要代码"></a>主要代码</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// 某个月的所有天</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// - Parameter year: 年份</span></span><br><span class="line"><span class="comment">/// - Parameter month: 月份</span></span><br><span class="line"><span class="comment">/// - Returns: 天的数组</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">daysInSomeMonth</span><span class="params">(year: Int, month: Int)</span></span> -&gt; [<span class="type">Weekday</span>] &#123;</span><br><span class="line">    <span class="keyword">let</span> calendar = <span class="type">Calendar</span>(identifier: .gregorian)</span><br><span class="line">    <span class="keyword">var</span> components = <span class="type">DateComponents</span>()</span><br><span class="line">    components.year = year</span><br><span class="line">    components.month = month</span><br><span class="line">    components.day = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> date = calendar.date(from: components)!</span><br><span class="line">    <span class="keyword">let</span> localDate = localData(<span class="type">GMT</span>: date) <span class="comment">// 本地时间</span></span><br><span class="line">    <span class="keyword">var</span> monthStartDate = <span class="type">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> interval: <span class="type">TimeInterval</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">let</span> <span class="number">_</span> = calendar.dateInterval(of: <span class="type">Calendar</span>.<span class="type">Component</span>.month, start: monthStartDate, interval: &amp;interval, <span class="keyword">for</span>: localDate)</span><br><span class="line">    <span class="keyword">let</span> endDate = <span class="type">Date</span>(timeInterval: interval - <span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>, since: localDate)</span><br><span class="line">    <span class="keyword">let</span> endComponents = calendar.dateComponents([.month, .day], from:endDate)</span><br><span class="line">    <span class="keyword">let</span> endDay = endComponents.day!</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> weekDays = [<span class="type">Weekday</span>]()</span><br><span class="line">    <span class="keyword">for</span> dayOfMonth <span class="keyword">in</span> <span class="number">1</span>...endDay &#123;</span><br><span class="line">        <span class="keyword">var</span> dayComponents = <span class="type">DateComponents</span>()</span><br><span class="line">        dayComponents.year = year</span><br><span class="line">        dayComponents.month = month</span><br><span class="line">        dayComponents.day = dayOfMonth</span><br><span class="line">        <span class="keyword">let</span> _date = calendar.date(from: dayComponents)!</span><br><span class="line">        <span class="keyword">let</span> _components = calendar.dateComponents([.weekday], from: _date)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> weekDay = <span class="type">Weekday</span>(day: dayOfMonth, weekday:_components.weekday!)</span><br><span class="line">        weekDays.append(weekDay)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> weekDays</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>先利用当月第一天的DateComponent获得对应的Date，然后转换成本地时间（北京时间），然后利用<code>public func dateInterval(of component: Calendar.Component, start: inout Date, interval: inout TimeInterval, for date: Date) -&gt; Bool</code>获得当月的天数，之后遍历当月的天数并得到每一天对应的是周几。其中<code>Date(timeInterval: interval - 60*60*24, since: localDate)</code>来保证得到的是当月的最后一天，如果没有<code>- 60*60*24</code>得到的是下月第一天。<br>将GMT时间转换成本地时间的方法是：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">localData</span><span class="params">(GMT date: Date)</span></span> -&gt; <span class="type">Date</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> timeZone = <span class="type">TimeZone</span>.current</span><br><span class="line">    <span class="keyword">let</span> interval = timeZone.secondsFromGMT()</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Date</span>(timeInterval: <span class="type">TimeInterval</span>(interval), since: date)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="待完善"><a href="#待完善" class="headerlink" title="待完善"></a>待完善</h3><p>目前得到的是某个月的日期，如果是完整的日历还需要可以左右滑动。</p>
<h3 id="github源码"><a href="#github源码" class="headerlink" title="github源码"></a>github源码</h3><p><a href="https://github.com/shizhiang/CalendarTutorial" target="_blank" rel="noopener">https://github.com/shizhiang/CalendarTutorial</a></p>
<p>👍👍👍</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.iosprogrammer.tech/Date-And-Time-Three/" data-id="ckcezpvjg000ekcs6e2sp2a70" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Date-And-Time-Two" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Date-And-Time-Two/" class="article-date">
  <time datetime="2018-04-19T13:48:38.000Z" itemprop="datePublished">2018-04-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>►<a class="article-category-link" href="/categories/iOS/日期Date和时间Time/">日期Date和时间Time</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Date-And-Time-Two/">日期Date和时间Time（二）- 日历计算</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在iOS开发过程中关于日历计算的需求都应该使用NSDate提供的方法，因为这些方法里面考虑了夏时制开始或者结束以及闰年等极端情况。</p>
<h3 id="将组件添加到Date"><a href="#将组件添加到Date" class="headerlink" title="将组件添加到Date"></a>将组件添加到Date</h3><p>使用<code>public func date(byAdding components: DateComponents, to date: Date, wrappingComponents: Bool = default) -&gt; Date?</code>方法给一个日期添加组件并得到一个新的日期。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> gregorian = <span class="type">Calendar</span>(identifier: .chinese)</span><br><span class="line"><span class="keyword">var</span> addingComponents = <span class="type">DateComponents</span>()</span><br><span class="line">addingComponents.day = <span class="number">1</span></span><br><span class="line">addingComponents.second = -<span class="number">10</span></span><br><span class="line">gregorian.date(byAdding: addingComponents, to: <span class="type">Date</span>())</span><br></pre></td></tr></table></figure></p>
<p>如上例，添加到日期的组件可以是负数。</p>
<p>获取本周的周日：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> gregorian = <span class="type">Calendar</span>(identifier: .chinese)</span><br><span class="line"><span class="keyword">let</span> weekdayComponents = gregorian.dateComponents([.weekday], from: <span class="type">Date</span>())</span><br><span class="line"><span class="built_in">print</span>(weekdayComponents.weekday!)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> componentsToSubtract = <span class="type">DateComponents</span>()</span><br><span class="line">componentsToSubtract.day = <span class="number">0</span> - (weekdayComponents.weekday! - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(componentsToSubtract.day!)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">let</span> beggingOfWeek = gregorian.date(byAdding: componentsToSubtract, to: <span class="type">Date</span>())</span><br><span class="line"><span class="built_in">print</span>(beggingOfWeek!)</span><br></pre></td></tr></table></figure></p>
<p>注意：上例的日历中每周是从周日开始的，有些日历不是这样。</p>
<h3 id="计算两个日期之间的间隔-网络时间协议NTP"><a href="#计算两个日期之间的间隔-网络时间协议NTP" class="headerlink" title="计算两个日期之间的间隔 网络时间协议NTP"></a>计算两个日期之间的间隔 <a href="https://baike.baidu.com/item/NTP/1100433" target="_blank" rel="noopener">网络时间协议NTP</a></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> gregorian = <span class="type">Calendar</span>(identifier: .gregorian)</span><br><span class="line"><span class="keyword">let</span> startDate = <span class="type">Date</span>()</span><br><span class="line"><span class="keyword">let</span> endDate = <span class="type">Date</span>(timeIntervalSinceNow: <span class="number">1000000</span>)</span><br><span class="line"><span class="keyword">let</span> dayComponents = gregorian.dateComponents([.day], from: startDate, to: endDate)</span><br><span class="line"><span class="built_in">print</span>(dayComponents.day!) <span class="comment">// 231</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">let</span> monthAndDayComponents = gregorian.dateComponents([.month, .day], from: startDate, to: endDate)</span><br><span class="line"><span class="built_in">print</span>(monthAndDayComponents.month!, monthAndDayComponents.day!) <span class="comment">// 7 17</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">let</span> monthComponents = gregorian.dateComponents([.month], from: startDate, to: endDate)</span><br><span class="line"><span class="built_in">print</span>(monthComponents.month!) <span class="comment">// 7</span></span><br></pre></td></tr></table></figure>
<p>从上例中可以看出，日期间隔的溢出被自动处理了（在dayComponents中，得到的是7个月零17天的天数）。<br>但是这个方法也会把计算结果截断为所提供的最小单位（monthComponents得到的只有7个月）。这个截断结果在某些情况下是我们所不希望得到的，如果说在即时通讯软件中，我们需要显示“一天前的聊天”，也就是当天的0点以后要把前一天的聊天显示为“一天前”，如果按照上面的方法，我们将会得到两个时间的间隔为0天，为了解决这个问题和得到我们想要的结果，可以使用下面的方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let gregorian = Calendar(identifier: .chinese)</span><br><span class="line">let startDate = Date() // 20:41</span><br><span class="line">let endDate = Date(timeIntervalSinceNow: 3600 * 5)</span><br><span class="line">let dayComponents = gregorian.dateComponents([.day], from: startDate, to: endDate)</span><br><span class="line">print(dayComponents.day!) // 0</span><br><span class="line">    </span><br><span class="line">let startDay = gregorian.ordinality(of: .day, in: .month, for: startDate)</span><br><span class="line">let endDay = gregorian.ordinality(of: .day, in: .month, for: endDate)</span><br><span class="line">print(endDay! - startDay!) // 1</span><br></pre></td></tr></table></figure></p>
<p>上面是分别用两个方法获取到的时间间隔，当前时间是20：41，结束时间是5小时后。至于哪个结果是我们想要的，要根据具体需求分析。其中，方法<code>open func ordinality(of smaller: NSCalendar.Unit, in larger: NSCalendar.Unit, for date: Date) -&gt; Int</code>是在一个较大的日期组件中获取指定日期的较小组件的数值。如果<code>larger &lt; smaller</code>将返回nil。</p>
<p>判断某个日期是否是本周<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">let calendar = Calendar(identifier: .chinese)</span><br><span class="line">let today = Date()</span><br><span class="line">var startDate = Date()</span><br><span class="line">var extends: TimeInterval = 0</span><br><span class="line">let success = calendar.dateInterval(of: .weekOfYear, start: &amp;startDate,interval: &amp;extends, for: today)</span><br><span class="line">if !success &#123;</span><br><span class="line">    print(&quot;失败&quot;)</span><br><span class="line">&#125;</span><br><span class="line">let testDate = Date(timeIntervalSinceNow: 100000)</span><br><span class="line">let dateInSecs = testDate.timeIntervalSinceReferenceDate</span><br><span class="line">let dayStartInSecs = startDate.timeIntervalSinceReferenceDate</span><br><span class="line">let dateInThisWeek = dayStartInSecs &lt; dateInSecs &amp;&amp; (dateInSecs &lt;(dayStartInSecs + extends))</span><br><span class="line">print(dateInThisWeek)</span><br></pre></td></tr></table></figure></p>
<p>先使用<code>dateInterval(of: .weekOfYear, start: &amp;startDate,interval: &amp;extends, for: today)</code>获取到本周的<code>startDate</code>和<code>weekOfYear</code>（一周）的<code>extends</code>（时长），然后根据要判断的日期距离指定日期的秒数是否大于本周开始日期距离指定日期的秒数，并且小于本周结束时日期距离指定日期的秒数。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.iosprogrammer.tech/Date-And-Time-Two/" data-id="ckcezpvjj000gkcs6etldd9al" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/Apple开发文档/">Apple开发文档</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/日期Date和时间Time/">日期Date和时间Time</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/react-native/">react-native</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/直播/">直播</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/读书/《Effective-Objective-C-2-0》/">《Effective Objective-C 2.0》</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/数据结构与算法分析/">数据结构与算法分析</a></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/DSAA-1-1/">引论</a>
          </li>
        
          <li>
            <a href="/Read-Effective-Objective-C-2-0-2/">读《Effective Objective-C 2.0》（二）</a>
          </li>
        
          <li>
            <a href="/Read-Effective-Objective-C-2-0-1/">读《Effective Objective-C 2.0》（一）</a>
          </li>
        
          <li>
            <a href="/Programming-With-ObjC/">OC编程基础</a>
          </li>
        
          <li>
            <a href="/KVC-KVO/">KVC/KVO 总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 施治昂<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>